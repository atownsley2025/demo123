<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Endless Flower Runner</title>
<style>
  body {
    margin:0; 
    background:#87ceeb;
    color:#fff; font-family:sans-serif; display:flex; flex-direction:column; align-items:center;
  }
  canvas {
    border:2px solid #1e2f78; border-radius:12px;
    box-shadow:0 10px 30px #0006; margin-top:8px;
  }
  #hud {margin:10px;font-size:18px;color:#111;font-weight:bold}
  button {
    margin:6px; padding:10px 14px; border-radius:8px; border:none;
    background:#1e2f78; color:#fff; font-weight:600; cursor:pointer
  }
</style>
</head>
<body>
<h2 style="color:#111;">Endless Flower Runner</h2>
<div id="hud">Level: <span id="lvl">1</span> · Attempts: <span id="tries">0</span> · Jumps: <span id="jumps">0</span></div>
<canvas id="game" width="800" height="400"></canvas>
<div>
  <button id="btnStart">▶ Start</button>
  <button id="btnStop">⏸ Stop</button>
</div>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");
const hudLvl=document.getElementById("lvl");
const hudTries=document.getElementById("tries");
const hudJumps=document.getElementById("jumps");
const btnStart=document.getElementById("btnStart");
const btnStop=document.getElementById("btnStop");

const GROUND_Y=340;
let STATE="idle";
let attemptCount=0, jumpCount=0, level=1;

const player={x:80,y:GROUND_Y-28,r:16,vy:0,onGround:true,jumpsLeft:2,maxJumps:2};
const input={justPressed:false};
const gravity=0.6;
let baseSpeed=3.5;  
let speed=baseSpeed;
let baseSpawn=220;  
let obstacles=[]; 
let spawnTimer=0;
let animationId;

// Clouds
let clouds=[];
for(let i=0;i<5;i++){
  clouds.push({x:i*160+Math.random()*100,y:40+Math.random()*60,w:60+Math.random()*40,h:30+Math.random()*15});
}

// Birds
let birds=[];
for(let i=0;i<6;i++){
  birds.push({x:Math.random()*canvas.width,y:60+Math.random()*40,speed:1+Math.random()*0.5,phase:Math.random()*Math.PI*2});
}

// Flower colors
const flowerColors=["#FFC0CB","#FF69B4","#FFFFFF"];

const COLORS={
  player:"#FFD43B",
  groundTop:"#3CB371",
  groundBottom:"#2E8B57"
};

function pressJump(){input.justPressed=true;}
window.addEventListener("keydown",e=>{
  if(["Space","ArrowUp","KeyW"].includes(e.code)){e.preventDefault();pressJump();}
});
canvas.addEventListener("pointerdown",pressJump);

btnStart.onclick=()=>{ if(STATE!=="running"){resetGame();STATE="running"; loop();} };
btnStop.onclick=()=>{ STATE="paused"; cancelAnimationFrame(animationId); };

function resetGame(){
  attemptCount=0; jumpCount=0; level=1;
  hudTries.textContent=attemptCount;
  hudJumps.textContent=jumpCount;
  hudLvl.textContent=level;
  obstacles=[]; spawnTimer=0;
  resetPlayer(); speed=baseSpeed;
}

function resetPlayer(){
  Object.assign(player,{x:80,y:GROUND_Y-player.r*2,vy:0,onGround:true,jumpsLeft:2});
}

function circleRectCollide(circle,rect){
  const cx=circle.x+circle.r, cy=circle.y+circle.r;
  const rx=Math.max(rect.x,Math.min(cx,rect.x+rect.w));
  const ry=Math.max(rect.y,Math.min(cy,rect.y+rect.h));
  const dx=cx-rx, dy=cy-ry;
  return dx*dx+dy*dy < circle.r*circle.r;
}

function update(){
  if(STATE!=="running")return;

  spawnTimer-=speed;
  if(spawnTimer<=0){
    obstacles.push({x:canvas.width+40,type:"flower",size:30+Math.random()*15,y:GROUND_Y,color:flowerColors[Math.floor(Math.random()*flowerColors.length)]});
    spawnTimer=baseSpawn - (level*5) + Math.random()*120;
    if(spawnTimer<80) spawnTimer=80;
  }
  for(const o of obstacles){o.x-=speed;}
  obstacles=obstacles.filter(o=>o.x+o.size>0);

  for(const c of clouds){c.x-=0.5; if(c.x+c.w<0) c.x=canvas.width+Math.random()*100;}

  for(const b of birds){
    b.x-=b.speed;
    b.phase+=0.2;
    if(b.x<-20){b.x=canvas.width+40; b.y=60+Math.random()*40;}
  }

  player.vy+=gravity;
  if(input.justPressed && player.jumpsLeft>0){
    player.vy=-12;
    player.onGround=false;
    player.jumpsLeft--;
    jumpCount++; hudJumps.textContent=jumpCount;
    if(jumpCount%10===0 && jumpCount>0){
      level++; hudLvl.textContent=level;
      speed=baseSpeed+level*0.3;
    }
  }
  input.justPressed=false;

  player.y+=player.vy;
  if(player.y+player.r*2>=GROUND_Y){
    player.y=GROUND_Y-player.r*2;
    player.vy=0;
    if(!player.onGround){
      player.onGround=true; player.jumpsLeft=player.maxJumps;
    }
  } else {player.onGround=false;}

  for(const o of obstacles){
    let rect={x:o.x,y:o.y-o.size,w:o.size,h:o.size};
    if(circleRectCollide(player,rect)){
      attemptCount++; hudTries.textContent=attemptCount;
      jumpCount=0; level=1;
      hudJumps.textContent=jumpCount; hudLvl.textContent=level;
      resetPlayer(); obstacles=[]; spawnTimer=0;
      speed=baseSpeed;
      break;
    }
  }
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // pastel sunset background
  let sky=ctx.createLinearGradient(0,0,0,GROUND_Y);
  sky.addColorStop(0,"#d6f0ff");   // light blue
  sky.addColorStop(0.5,"#ffe5b4"); // light orange
  sky.addColorStop(1,"#ffd6e7");   // light pink
  ctx.fillStyle=sky;
  ctx.fillRect(0,0,canvas.width,GROUND_Y);

  // sun glow lower in the sky
  let sunX=canvas.width-140, sunY=GROUND_Y*0.5;
  let grad=ctx.createRadialGradient(sunX,sunY,20,sunX,sunY,100);
  grad.addColorStop(0,"#FFD43B");
  grad.addColorStop(1,"rgba(255,212,59,0)");
  ctx.fillStyle=grad;
  ctx.beginPath();
  ctx.arc(sunX,sunY,100,0,Math.PI*2);
  ctx.fill();

  // clouds
  ctx.fillStyle="rgba(255,255,255,0.8)";
  for(const c of clouds){
    ctx.beginPath();
    ctx.ellipse(c.x,c.y,c.w/2,c.h/2,0,0,Math.PI*2);
    ctx.ellipse(c.x+20,c.y-10,c.w/2.5,c.h/2.5,0,0,Math.PI*2);
    ctx.ellipse(c.x+40,c.y,c.w/2.5,c.h/2.5,0,0,Math.PI*2);
    ctx.fill();
  }

  // birds with flapping wings
  ctx.strokeStyle="#333"; ctx.lineWidth=2;
  for(const b of birds){
    let flap=Math.sin(b.phase)*6;
    ctx.beginPath();
    ctx.moveTo(b.x,b.y);
    ctx.lineTo(b.x+8,b.y+flap);
    ctx.moveTo(b.x,b.y);
    ctx.lineTo(b.x-8,b.y+flap);
    ctx.stroke();
  }

  // ground gradient
  let ground=ctx.createLinearGradient(0,GROUND_Y,0,canvas.height);
  ground.addColorStop(0,COLORS.groundTop);
  ground.addColorStop(1,COLORS.groundBottom);
  ctx.fillStyle=ground;
  ctx.fillRect(0,GROUND_Y,canvas.width,canvas.height-GROUND_Y);

  // flowers
  for(const o of obstacles){
    drawFlower(o.x+o.size/2,o.y,o.size,o.color);
  }

  // player
  ctx.fillStyle=COLORS.player;
  ctx.beginPath();
  ctx.arc(player.x+player.r,player.y+player.r,player.r,0,Math.PI*2);
  ctx.fill();
}

function drawFlower(x,y,size,color){
  // stem
  ctx.strokeStyle="#2E8B57"; ctx.lineWidth=3;
  ctx.beginPath();
  ctx.moveTo(x,y);
  ctx.lineTo(x,y-size);
  ctx.stroke();
  // leaves on stem
  ctx.fillStyle="#2E8B57";
  ctx.beginPath();
  ctx.ellipse(x-6,y-size/2,6,3,Math.PI/4,0,Math.PI*2);
  ctx.fill();
  ctx.beginPath();
  ctx.ellipse(x+6,y-size/2,6,3,-Math.PI/4,0,Math.PI*2);
  ctx.fill();
  // petals
  const petalCount=6;
  const radius=12;
  ctx.fillStyle=color;
  for(let i=0;i<petalCount;i++){
    const angle=(Math.PI*2/petalCount)*i;
    const px=x+Math.cos(angle)*radius;
    const py=y-size+Math.sin(angle)*radius;
    ctx.beginPath();
    ctx.arc(px,py,6,0,Math.PI*2);
    ctx.fill();
  }
  // pistil
  ctx.fillStyle="#FFD93D";
  ctx.beginPath();
  ctx.arc(x,y-size,7,0,Math.PI*2);
  ctx.fill();
}

function loop(){
  update(); draw();
  animationId=requestAnimationFrame(loop);
}
</script>
</body>
</html>



