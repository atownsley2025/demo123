<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Impossible Game - 5 Levels</title>
  <style>
    body { margin:0; background:#111; overflow:hidden; display:flex; justify-content:center; align-items:center; height:100vh; flex-direction:column; }
    canvas { display:none; background:#222; margin-top:20px; }
    button {
      padding: 15px 30px;
      font-size: 20px;
      border: none;
      border-radius: 10px;
      background: orange;
      color: white;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0,0,0,0.4);
      transition: 0.2s;
      margin: 10px;
    }
    button:hover {
      background: darkorange;
      transform: scale(1.05);
    }
  </style>
</head>
<body>
  <h1 style="color:white; font-family:sans-serif;">Impossible Game</h1>
  <button id="startBtn">Start Game</button>
  <button id="retryBtn" style="display:none;">Retry</button>
  <button id="nextBtn" style="display:none;">Next Level</button>
  <canvas id="gameCanvas" width="800" height="400"></canvas>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    const startBtn = document.getElementById("startBtn");
    const retryBtn = document.getElementById("retryBtn");
    const nextBtn = document.getElementById("nextBtn");

    let level = 1;
    let player, obstacles, speed, gameOver, gameStarted, obstacleMove, win;

    function setupLevel(lvl) {
      player = { x: 50, y: 300, width: 30, height: 30, dy: 0, gravity: 0.6, jumpPower: -12, grounded: false };

      // Each level gets harder
      speed = 3 + lvl; 
      const height = Math.max(20, 60 - lvl*5); // taller on easy, shorter jumps later
      const spacing = 350 - lvl*50; // obstacles closer later
      obstacles = [];
      for (let i = 0; i < 4 + lvl; i++) {
        obstacles.push({ x: 400 + i*spacing, y: 360 - height, width: 20, height: height });
      }

      gameOver = false;
      gameStarted = false;
      obstacleMove = false;
      win = false;
    }

    function drawPlayer() {
      ctx.fillStyle = "orange";
      ctx.fillRect(player.x, player.y, player.width, player.height);
    }

    function drawObstacles() {
      ctx.fillStyle = "red";
      for (let obs of obstacles) {
        ctx.fillRect(obs.x, obs.y, obs.width, obs.height);
      }
    }

    function update() {
      if (!gameStarted || gameOver) return;

      ctx.clearRect(0,0,canvas.width,canvas.height);

      // Gravity
      player.y += player.dy;
      player.dy += player.gravity;

      // Ground
      if (player.y + player.height >= 360) {
        player.y = 360 - player.height;
        player.dy = 0;
        player.grounded = true;
      } else {
        player.grounded = false;
      }

      if (obstacleMove) {
        for (let obs of obstacles) {
          obs.x -= speed;

          // Collision check
          if (
            player.x < obs.x + obs.width &&
            player.x + player.width > obs.x &&
            player.y < obs.y + obs.height &&
            player.y + player.height > obs.y
          ) {
            gameOver = true;
            retryBtn.style.display = "inline-block";
            return;
          }
        }

        // Win condition
        if (obstacles[obstacles.length - 1].x + obstacles[0].width < 0 && !win) {
          win = true;
          if (level < 5) {
            nextBtn.style.display = "inline-block";
          } else {
            alert("ðŸŽ‰ You beat all 5 levels! ðŸŽ‰");
            retryBtn.style.display = "inline-block";
          }
          return;
        }
      }

      drawPlayer();
      drawObstacles();

      requestAnimationFrame(update);
    }

    function jump() {
      if (player.grounded) {
        player.dy = player.jumpPower;
        player.grounded = false;
      }
    }

    document.addEventListener("keydown", e => {
      if (e.code === "Space") jump();
    });

    startBtn.addEventListener("click", () => {
      startBtn.style.display = "none";
      canvas.style.display = "block";
      setupLevel(level);
      gameStarted = true;
      setTimeout(() => obstacleMove = true, 2000);
      update();
    });

    retryBtn.addEventListener("click", () => {
      retryBtn.style.display = "none";
      nextBtn.style.display = "none";
      setupLevel(level);
      gameStarted = true;
      setTimeout(() => obstacleMove = true, 2000);
      update();
    });

    nextBtn.addEventListener("click", () => {
      level++;
      retryBtn.style.display = "none";
      nextBtn.style.display = "none";
      setupLevel(level);
      gameStarted = true;
      setTimeout(() => obstacleMove = true, 2000);
      update();
    });
  </script>
</body>
</html>
